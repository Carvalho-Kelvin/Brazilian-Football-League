Brazilian Football Match Prediction and Analysis
This project provides tools for analyzing Brazilian SÃ©rie A football match data, calculating team rankings, predicting match outcomes, and performing feature importance analysis using machine learning models. The goal is to understand which statistics are most influential in determining match results and team performance in the Brazilian League.

Features
Data Loading: Securely loads match data from a Google Sheet.

Data Cleaning & Transformation:
Cleans and standardizes team names.
Converts data types for numerical analysis.
Handles missing or infinite values.

Team Ranking Calculation:
Calculates overall, home, and away rankings for teams based on various per-game statistics (Goals For, Goals Against, Possession, Shots on Goal, Corners, Saves, etc.).

Computes advanced metrics like percentage of goals per shot, percentage of goals per shot on goal, and percentage of saves per shots on goal against.

Last 5 Games Form: Calculates recent form statistics (Goals For and Goals Against per game) for each team based on their last 5 matches.

Expected Goals (xG) Calculation:
Calculates multiple xG metrics (xG1, xG2, xG3, xG4) based on different statistical approaches (overall performance, home/away splits, shots on goal, recent form).
Combines these xG metrics into a weighted total xG for both home and away teams, incorporating feature importances derived from a machine learning model.

Match Outcome Probability Prediction:
Uses Poisson distribution based on calculated xG values to predict probabilities for Home Win, Draw, and Away Win.

Machine Learning Feature Importance Analysis:
Utilizes a Random Forest Regressor to determine the importance of various per-game statistics (Poss_pg, GF_pg, GA_pg, SoG_pg, etc.) in predicting Pts_pg (Points per game).
Saves these feature importances to a CSV file for use in other parts of the project.

Model Evaluation:
Performs train-test splits and K-Fold Cross-Validation to evaluate the performance of the Pts_pg prediction model using metrics like Mean Absolute Error (MAE), Mean Squared Error (MSE), Root Mean Squared Error (RMSE), and R-squared.

Google Sheets Integration: Exports calculated rankings and updated match probabilities to specified Google Sheets.

Setup and Installation
Clone the repository:

git clone <repository_url>
cd brazilian-football-project

Create a Python Virtual Environment (Recommended):

python -m venv myenv

On Windows:

myenv\Scripts\activate

On macOS/Linux:

source myenv/bin/activate

Install Dependencies:

pip install pandas numpy scikit-learn gspread oauth2client gspread_dataframe matplotlib

Google Sheets API Credentials:

This project uses the Google Sheets API to load and update data. You need to set up a Google Cloud Project and enable the Google Sheets API.

Create a service account and download its JSON key file.

Rename the downloaded JSON key file to brazilian-football.json and place it in the root directory of your project.

Share your Google Sheet (specified by _SHEET_URL in loader.py) with the email address of your service account.

Project Structure
loader.py: Handles data loading from the Google Sheet.

main.py: Contains the core logic for data cleaning, ranking calculation, xG calculation, match probability prediction, and Google Sheets updates.

feature_analysis.py: Performs feature importance analysis using a Random Forest Regressor and saves the importance scores.

brazilian-football.json: Your Google Sheets API service account credential file (should be placed here).

feature_importances.csv: (Generated by feature_analysis.py) Stores the feature importance scores used by main.py.

Usage
Generate Feature Importances:
Run feature_analysis.py first. This will train the Random Forest model, print feature importances, display a plot, and save the importances to feature_importances.csv.

python feature_analysis.py

Run the Main Prediction and Ranking Script:
After feature_importances.csv is generated, run main.py. This will load data, calculate rankings and xG, predict match probabilities, and update your Google Sheet.

python main.py

Future Enhancements
Advanced ML Models for Match Outcome: Explore more sophisticated classification models (e.g., Gradient Boosting, Neural Networks) for direct match outcome prediction.

Probabilistic Forecast Evaluation: Implement and monitor Brier Score and Log-Loss to rigorously evaluate the quality and calibration of predicted probabilities.

Dixon-Coles Correction: Refine the Poisson model to account for correlation between home and away goals (e.g., to better predict 0-0 draws).

Opponent Strength Weighting: Further refine how opponent strength is factored into xG and other statistical calculations.

Time Series Analysis: Incorporate time-series aspects to account for team form trends and recent performance more dynamically.

Player-Level Data: If available, integrate player-level statistics (e.g., player ratings, injuries) to enhance prediction accuracy.

User Interface: Develop a simple web interface to visualize predictions and rankings.
